# 音乐生成供应商 API 对接待办

> 创建时间：2025-12-28
> 更新时间：2025-12-28
> 状态：Minimax 已确认，Suno 待确认

---

## 多供应商策略

| 供应商 | 模式 | 状态 | 说明 |
|--------|------|------|------|
| **Minimax** | Text-to-Music | ✅ 已确认 | 文字生成模式主力供应商 |
| **Suno** | Audio-to-Music | ⬜ 待确认 | 音频生成模式备选供应商 |

---

## Minimax 对接计划

### API 能力确认

| 能力 | 支持 | 说明 |
|------|------|------|
| 歌词输入 | ✅ | `lyrics` 参数，支持结构标签 |
| 风格描述 | ✅ | `prompt` 参数，10-2000 字符 |
| 音频输出 | ✅ | URL 或 hex 格式 |
| A/B 双版本 | ⚠️ | 需调用两次，成本 2x |
| 音频输入 | ❌ | 不支持 Audio-to-Music |

### 前端参数映射

| 前端参数 | Minimax 支持 | 映射方式 |
|----------|--------------|----------|
| `style` | ✅ | → `prompt` |
| `lyrics` | ✅ | → `lyrics` |
| `voiceType` | ⚠️ | 追加到 `prompt`："女声演唱" |
| `excludeStyles` | ⚠️ | 追加到 `prompt`："避免xxx风格" |
| `tension` | ❌ | 不支持，隐藏或忽略 |
| `styleLock` | ❌ | 不支持，隐藏或忽略 |
| `segment` | ❌ | 不适用（无音频输入） |
| `textMode` | ❌ | 不支持 |

### 开发任务

- [ ] 实现 MinimaxProvider (`workers/media/src/providers/minimax.ts`)
- [ ] 更新 Provider 接口支持 Text-to-Music 模式
- [ ] 前端添加"文字模式"入口
- [ ] 文字模式下隐藏录音/上传/片段选择步骤
- [ ] 文字模式下歌词改为必填
- [ ] 隐藏不支持的高级设置（tension/styleLock/textMode）
- [ ] A/B 版本：并行调用两次 Minimax API
- [ ] 错误码映射到统一错误体系
- [ ] 端到端测试

---

## Suno 待确认事项

### 需要你提供

1. **API 接入方式**
   - 官方 API？第三方代理？
   - 是否有可用的 API Key？

2. **API 文档**
   - 请求/响应格式
   - 认证方式
   - 错误码列表

3. **能力确认**
   - 是否支持 Audio-to-Music（音频输入）？
   - 是否原生支持 A/B 双版本？
   - 支持哪些参数？

### 预期能力（待验证）

| 能力 | 预期 | 确认状态 |
|------|------|----------|
| 音频输入 | ✅ | ⬜ 待确认 |
| 风格指定 | ✅ | ⬜ 待确认 |
| 片段选择 | ⬜ | ⬜ 待确认 |
| A/B 版本 | ⬜ | ⬜ 待确认 |
| 歌词输入 | ⬜ | ⬜ 待确认 |

---

## 下一步行动

### 立即可做（Minimax）

- [ ] **你**：提供 Minimax API Key
- [ ] **我**：实现 MinimaxProvider
- [ ] **我**：前端添加文字模式
- [ ] **共同**：端到端测试

### 待确认后（Suno）

- [ ] **你**：确认 Suno API 供应商
- [ ] **你**：提供 API 文档
- [ ] **我**：评估能力，实现 SunoProvider
- [ ] **我**：前端音频模式对接
- [ ] **共同**：端到端测试

---

## 相关文档

- PRD 供应商策略：`01_PRD/v0-web/PRD.md` 第 8 节
- Provider 代码：`workers/media/src/providers/`
- 环境变量：`.env.example`
